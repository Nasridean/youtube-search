не успел сделать до конца, но кое-какой код есть хотя бы.